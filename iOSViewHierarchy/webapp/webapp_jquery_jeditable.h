//
//  webapp_jquery_jeditable.h
//  iOSHierarchyViewer
//
//
// THIS FILE IS GENERATED AUTOMATICALLY BY XCODE's script
//
//

#ifndef iOSHierarchyViewer_webapp_jquery_jeditable 
#define iOSHierarchyViewer_webapp_jquery_jeditable 

#define WEBAPP_JQUERY_JEDITABLE @"LyoKICogSmVkaXRhYmxlIC0galF1ZXJ5IGluIHBsYWNlIGVkaXQgcGx1Z2luCiAqCiAqIENvcHlyaWdodCAoYykgMjAwNi0yMDA5IE1pa2EgVHV1cG9sYSwgRHlsYW4gVmVyaGV1bAogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2U6CiAqICAgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHAKICoKICogUHJvamVjdCBob21lOgogKiAgIGh0dHA6Ly93d3cuYXBwZWxzaWluaS5uZXQvcHJvamVjdHMvamVkaXRhYmxlCiAqCiAqIEJhc2VkIG9uIGVkaXRhYmxlIGJ5IER5bGFuIFZlcmhldWwgPGR5bGFuX2F0X2R5dmUubmV0PjoKICogICAgaHR0cDovL3d3dy5keXZlLm5ldC9qcXVlcnkvP2VkaXRhYmxlCiAqCiAqLwoKLyoqCiAgKiBWZXJzaW9uIDEuNy4xCiAgKgogICogKiogbWVhbnMgdGhlcmUgaXMgYmFzaWMgdW5pdCB0ZXN0cyBmb3IgdGhpcyBwYXJhbWV0ZXIuIAogICoKICAqIEBuYW1lICBKZWRpdGFibGUKICAqIEB0eXBlICBqUXVlcnkKICAqIEBwYXJhbSBTdHJpbmcgIHRhcmdldCAgICAgICAgICAgICAoUE9TVCkgVVJMIG9yIGZ1bmN0aW9uIHRvIHNlbmQgZWRpdGVkIGNvbnRlbnQgdG8gKioKICAqIEBwYXJhbSBIYXNoICAgIG9wdGlvbnMgICAgICAgICAgICBhZGRpdGlvbmFsIG9wdGlvbnMgCiAgKiBAcGFyYW0gU3RyaW5nICBvcHRpb25zW21ldGhvZF0gICAgbWV0aG9kIHRvIHVzZSB0byBzZW5kIGVkaXRlZCBjb250ZW50IChQT1NUIG9yIFBVVCkgKioKICAqIEBwYXJhbSBGdW5jdGlvbiBvcHRpb25zW2NhbGxiYWNrXSBGdW5jdGlvbiB0byBydW4gYWZ0ZXIgc3VibWl0dGluZyBlZGl0ZWQgY29udGVudCAqKgogICogQHBhcmFtIFN0cmluZyAgb3B0aW9uc1tuYW1lXSAgICAgIFBPU1QgcGFyYW1ldGVyIG5hbWUgb2YgZWRpdGVkIGNvbnRlbnQKICAqIEBwYXJhbSBTdHJpbmcgIG9wdGlvbnNbaWRdICAgICAgICBQT1NUIHBhcmFtZXRlciBuYW1lIG9mIGVkaXRlZCBkaXYgaWQKICAqIEBwYXJhbSBIYXNoICAgIG9wdGlvbnNbc3VibWl0ZGF0YV0gRXh0cmEgcGFyYW1ldGVycyB0byBzZW5kIHdoZW4gc3VibWl0dGluZyBlZGl0ZWQgY29udGVudC4KICAqIEBwYXJhbSBTdHJpbmcgIG9wdGlvbnNbdHlwZV0gICAgICB0ZXh0LCB0ZXh0YXJlYSBvciBzZWxlY3QgKG9yIGFueSAzcmQgcGFydHkgaW5wdXQgdHlwZSkgKioKICAqIEBwYXJhbSBJbnRlZ2VyIG9wdGlvbnNbcm93c10gICAgICBudW1iZXIgb2Ygcm93cyBpZiB1c2luZyB0ZXh0YXJlYSAqKiAKICAqIEBwYXJhbSBJbnRlZ2VyIG9wdGlvbnNbY29sc10gICAgICBudW1iZXIgb2YgY29sdW1ucyBpZiB1c2luZyB0ZXh0YXJlYSAqKgogICogQHBhcmFtIE1peGVkICAgb3B0aW9uc1toZWlnaHRdICAgICdhdXRvJywgJ25vbmUnIG9yIGhlaWdodCBpbiBwaXhlbHMgKioKICAqIEBwYXJhbSBNaXhlZCAgIG9wdGlvbnNbd2lkdGhdICAgICAnYXV0bycsICdub25lJyBvciB3aWR0aCBpbiBwaXhlbHMgKioKICAqIEBwYXJhbSBTdHJpbmcgIG9wdGlvbnNbbG9hZHVybF0gICBVUkwgdG8gZmV0Y2ggaW5wdXQgY29udGVudCBiZWZvcmUgZWRpdGluZyAqKgogICogQHBhcmFtIFN0cmluZyAgb3B0aW9uc1tsb2FkdHlwZV0gIFJlcXVlc3QgdHlwZSBmb3IgbG9hZCB1cmwuIFNob3VsZCBiZSBHRVQgb3IgUE9TVC4KICAqIEBwYXJhbSBTdHJpbmcgIG9wdGlvbnNbbG9hZHRleHRdICBUZXh0IHRvIGRpc3BsYXkgd2hpbGUgbG9hZGluZyBleHRlcm5hbCBjb250ZW50LgogICogQHBhcmFtIE1peGVkICAgb3B0aW9uc1tsb2FkZGF0YV0gIEV4dHJhIHBhcmFtZXRlcnMgdG8gcGFzcyB3aGVuIGZldGNoaW5nIGNvbnRlbnQgYmVmb3JlIGVkaXRpbmcuCiAgKiBAcGFyYW0gTWl4ZWQgICBvcHRpb25zW2RhdGFdICAgICAgT3IgY29udGVudCBnaXZlbiBhcyBwYXJhbWFtZXRlci4gU3RyaW5nIG9yIGZ1bmN0aW9uLioqCiAgKiBAcGFyYW0gU3RyaW5nICBvcHRpb25zW2luZGljYXRvcl0gaW5kaWNhdG9yIGh0bWwgdG8gc2hvdyB3aGVuIHNhdmluZwogICogQHBhcmFtIFN0cmluZyAgb3B0aW9uc1t0b29sdGlwXSAgIG9wdGlvbmFsIHRvb2x0aXAgdGV4dCB2aWEgdGl0bGUgYXR0cmlidXRlICoqCiAgKiBAcGFyYW0gU3RyaW5nICBvcHRpb25zW2V2ZW50XSAgICAgalF1ZXJ5IGV2ZW50IHN1Y2ggYXMgJ2NsaWNrJyBvZiAnZGJsY2xpY2snICoqCiAgKiBAcGFyYW0gU3RyaW5nICBvcHRpb25zW3N1Ym1pdF0gICAgc3VibWl0IGJ1dHRvbiB2YWx1ZSwgZW1wdHkgbWVhbnMgbm8gYnV0dG9uICoqCiAgKiBAcGFyYW0gU3RyaW5nICBvcHRpb25zW2NhbmNlbF0gICAgY2FuY2VsIGJ1dHRvbiB2YWx1ZSwgZW1wdHkgbWVhbnMgbm8gYnV0dG9uICoqCiAgKiBAcGFyYW0gU3RyaW5nICBvcHRpb25zW2Nzc2NsYXNzXSAgQ1NTIGNsYXNzIHRvIGFwcGx5IHRvIGlucHV0IGZvcm0uICdpbmhlcml0JyB0byBjb3B5IGZyb20gcGFyZW50LiAqKgogICogQHBhcmFtIFN0cmluZyAgb3B0aW9uc1tzdHlsZV0gICAgIFN0eWxlIHRvIGFwcGx5IHRvIGlucHV0IGZvcm0gJ2luaGVyaXQnIHRvIGNvcHkgZnJvbSBwYXJlbnQuICoqCiAgKiBAcGFyYW0gU3RyaW5nICBvcHRpb25zW3NlbGVjdF0gICAgdHJ1ZSBvciBmYWxzZSwgd2hlbiB0cnVlIHRleHQgaXMgaGlnaGxpZ2h0ZWQgPz8KICAqIEBwYXJhbSBTdHJpbmcgIG9wdGlvbnNbcGxhY2Vob2xkZXJdIFBsYWNlaG9sZGVyIHRleHQgb3IgaHRtbCB0byBpbnNlcnQgd2hlbiBlbGVtZW50IGlzIGVtcHR5LiAqKgogICogQHBhcmFtIFN0cmluZyAgb3B0aW9uc1tvbmJsdXJdICAgICdjYW5jZWwnLCAnc3VibWl0JywgJ2lnbm9yZScgb3IgZnVuY3Rpb24gPz8KICAqICAgICAgICAgICAgIAogICogQHBhcmFtIEZ1bmN0aW9uIG9wdGlvbnNbb25zdWJtaXRdIGZ1bmN0aW9uKHNldHRpbmdzLCBvcmlnaW5hbCkgeyAuLi4gfSBjYWxsZWQgYmVmb3JlIHN1Ym1pdAogICogQHBhcmFtIEZ1bmN0aW9uIG9wdGlvbnNbb25yZXNldF0gIGZ1bmN0aW9uKHNldHRpbmdzLCBvcmlnaW5hbCkgeyAuLi4gfSBjYWxsZWQgYmVmb3JlIHJlc2V0CiAgKiBAcGFyYW0gRnVuY3Rpb24gb3B0aW9uc1tvbmVycm9yXSAgZnVuY3Rpb24oc2V0dGluZ3MsIG9yaWdpbmFsLCB4aHIpIHsgLi4uIH0gY2FsbGVkIG9uIGVycm9yCiAgKiAgICAgICAgICAgICAKICAqIEBwYXJhbSBIYXNoICAgIG9wdGlvbnNbYWpheG9wdGlvbnNdICBqUXVlcnkgQWpheCBvcHRpb25zLiBTZWUgZG9jcy5qcXVlcnkuY29tLgogICogICAgICAgICAgICAgCiAgKi8KCihmdW5jdGlvbigkKSB7CgogICAgJC5mbi5lZGl0YWJsZSA9IGZ1bmN0aW9uKHRhcmdldCwgb3B0aW9ucykgewogICAgICAgICAgICAKICAgICAgICBpZiAoJ2Rpc2FibGUnID09IHRhcmdldCkgewogICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ2Rpc2FibGVkLmVkaXRhYmxlJywgdHJ1ZSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCdlbmFibGUnID09IHRhcmdldCkgewogICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ2Rpc2FibGVkLmVkaXRhYmxlJywgZmFsc2UpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICgnZGVzdHJveScgPT0gdGFyZ2V0KSB7CiAgICAgICAgICAgICQodGhpcykKICAgICAgICAgICAgICAgIC51bmJpbmQoJCh0aGlzKS5kYXRhKCdldmVudC5lZGl0YWJsZScpKQogICAgICAgICAgICAgICAgLnJlbW92ZURhdGEoJ2Rpc2FibGVkLmVkaXRhYmxlJykKICAgICAgICAgICAgICAgIC5yZW1vdmVEYXRhKCdldmVudC5lZGl0YWJsZScpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHZhciBzZXR0aW5ncyA9ICQuZXh0ZW5kKHt9LCAkLmZuLmVkaXRhYmxlLmRlZmF1bHRzLCB7dGFyZ2V0OnRhcmdldH0sIG9wdGlvbnMpOwogICAgICAgIAogICAgICAgIC8qIHNldHVwIHNvbWUgZnVuY3Rpb25zICovCiAgICAgICAgdmFyIHBsdWdpbiAgID0gJC5lZGl0YWJsZS50eXBlc1tzZXR0aW5ncy50eXBlXS5wbHVnaW4gfHwgZnVuY3Rpb24oKSB7IH07CiAgICAgICAgdmFyIHN1Ym1pdCAgID0gJC5lZGl0YWJsZS50eXBlc1tzZXR0aW5ncy50eXBlXS5zdWJtaXQgfHwgZnVuY3Rpb24oKSB7IH07CiAgICAgICAgdmFyIGJ1dHRvbnMgID0gJC5lZGl0YWJsZS50eXBlc1tzZXR0aW5ncy50eXBlXS5idXR0b25zIAogICAgICAgICAgICAgICAgICAgIHx8ICQuZWRpdGFibGUudHlwZXNbJ2RlZmF1bHRzJ10uYnV0dG9uczsKICAgICAgICB2YXIgY29udGVudCAgPSAkLmVkaXRhYmxlLnR5cGVzW3NldHRpbmdzLnR5cGVdLmNvbnRlbnQgCiAgICAgICAgICAgICAgICAgICAgfHwgJC5lZGl0YWJsZS50eXBlc1snZGVmYXVsdHMnXS5jb250ZW50OwogICAgICAgIHZhciBlbGVtZW50ICA9ICQuZWRpdGFibGUudHlwZXNbc2V0dGluZ3MudHlwZV0uZWxlbWVudCAKICAgICAgICAgICAgICAgICAgICB8fCAkLmVkaXRhYmxlLnR5cGVzWydkZWZhdWx0cyddLmVsZW1lbnQ7CiAgICAgICAgdmFyIHJlc2V0ICAgID0gJC5lZGl0YWJsZS50eXBlc1tzZXR0aW5ncy50eXBlXS5yZXNldCAKICAgICAgICAgICAgICAgICAgICB8fCAkLmVkaXRhYmxlLnR5cGVzWydkZWZhdWx0cyddLnJlc2V0OwogICAgICAgIHZhciBjYWxsYmFjayA9IHNldHRpbmdzLmNhbGxiYWNrIHx8IGZ1bmN0aW9uKCkgeyB9OwogICAgICAgIHZhciBvbmVkaXQgICA9IHNldHRpbmdzLm9uZWRpdCAgIHx8IGZ1bmN0aW9uKCkgeyB9OyAKICAgICAgICB2YXIgb25zdWJtaXQgPSBzZXR0aW5ncy5vbnN1Ym1pdCB8fCBmdW5jdGlvbigpIHsgfTsKICAgICAgICB2YXIgb25yZXNldCAgPSBzZXR0aW5ncy5vbnJlc2V0ICB8fCBmdW5jdGlvbigpIHsgfTsKICAgICAgICB2YXIgb25lcnJvciAgPSBzZXR0aW5ncy5vbmVycm9yICB8fCByZXNldDsKICAgICAgICAgIAogICAgICAgIC8qIHNob3cgdG9vbHRpcCAqLwogICAgICAgIGlmIChzZXR0aW5ncy50b29sdGlwKSB7CiAgICAgICAgICAgICQodGhpcykuYXR0cigndGl0bGUnLCBzZXR0aW5ncy50b29sdGlwKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgc2V0dGluZ3MuYXV0b3dpZHRoICA9ICdhdXRvJyA9PSBzZXR0aW5ncy53aWR0aDsKICAgICAgICBzZXR0aW5ncy5hdXRvaGVpZ2h0ID0gJ2F1dG8nID09IHNldHRpbmdzLmhlaWdodDsKICAgICAgICAKICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgLyogc2F2ZSB0aGlzIHRvIHNlbGYgYmVjYXVzZSB0aGlzIGNoYW5nZXMgd2hlbiBzY29wZSBjaGFuZ2VzICovCiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpczsgIAogICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIC8qIGlubGluZWQgYmxvY2sgZWxlbWVudHMgbG9zZSB0aGVpciB3aWR0aCBhbmQgaGVpZ2h0IGFmdGVyIGZpcnN0IGVkaXQgKi8KICAgICAgICAgICAgLyogc2F2ZSB0aGVtIGZvciBsYXRlciB1c2UgYXMgd29ya2Fyb3VuZCAqLwogICAgICAgICAgICB2YXIgc2F2ZWR3aWR0aCAgPSAkKHNlbGYpLndpZHRoKCk7CiAgICAgICAgICAgIHZhciBzYXZlZGhlaWdodCA9ICQoc2VsZikuaGVpZ2h0KCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAvKiBzYXZlIHNvIGl0IGNhbiBiZSBsYXRlciB1c2VkIGJ5ICQuZWRpdGFibGUoJ2Rlc3Ryb3knKSAqLwogICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ2V2ZW50LmVkaXRhYmxlJywgc2V0dGluZ3MuZXZlbnQpOwogICAgICAgICAgICAKICAgICAgICAgICAgLyogaWYgZWxlbWVudCBpcyBlbXB0eSBhZGQgc29tZXRoaW5nIGNsaWNrYWJsZSAoaWYgcmVxdWVzdGVkKSAqLwogICAgICAgICAgICBpZiAoISQudHJpbSgkKHRoaXMpLmh0bWwoKSkpIHsKICAgICAgICAgICAgICAgICQodGhpcykuaHRtbChzZXR0aW5ncy5wbGFjZWhvbGRlcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgICQodGhpcykuYmluZChzZXR0aW5ncy5ldmVudCwgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvKiBhYm9ydCBpZiBkaXNhYmxlZCBmb3IgdGhpcyBlbGVtZW50ICovCiAgICAgICAgICAgICAgICBpZiAodHJ1ZSA9PT0gJCh0aGlzKS5kYXRhKCdkaXNhYmxlZC5lZGl0YWJsZScpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvKiBwcmV2ZW50IHRocm93aW5nIGFuIGV4ZXB0aW9uIGlmIGVkaXQgZmllbGQgaXMgY2xpY2tlZCBhZ2FpbiAqLwogICAgICAgICAgICAgICAgaWYgKHNlbGYuZWRpdGluZykgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLyogYWJvcnQgaWYgb25lZGl0IGhvb2sgcmV0dXJucyBmYWxzZSAqLwogICAgICAgICAgICAgICAgaWYgKGZhbHNlID09PSBvbmVkaXQuYXBwbHkodGhpcywgW3NldHRpbmdzLCBzZWxmXSkpIHsKICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLyogcHJldmVudCBkZWZhdWx0IGFjdGlvbiBhbmQgYnViYmxpbmcgKi8KICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8qIHJlbW92ZSB0b29sdGlwICovCiAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MudG9vbHRpcCkgewogICAgICAgICAgICAgICAgICAgICQoc2VsZikucmVtb3ZlQXR0cigndGl0bGUnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLyogZmlndXJlIG91dCBob3cgd2lkZSBhbmQgdGFsbCB3ZSBhcmUsIHNhdmVkIHdpZHRoIGFuZCBoZWlnaHQgKi8KICAgICAgICAgICAgICAgIC8qIGFyZSB3b3JrYXJvdW5kIGZvciBodHRwOi8vZGV2LmpxdWVyeS5jb20vdGlja2V0LzIxOTAgKi8KICAgICAgICAgICAgICAgIGlmICgwID09ICQoc2VsZikud2lkdGgoKSkgewogICAgICAgICAgICAgICAgICAgIC8vJChzZWxmKS5jc3MoJ3Zpc2liaWxpdHknLCAnaGlkZGVuJyk7CiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3Mud2lkdGggID0gc2F2ZWR3aWR0aDsKICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5oZWlnaHQgPSBzYXZlZGhlaWdodDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLndpZHRoICE9ICdub25lJykgewogICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy53aWR0aCA9IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MuYXV0b3dpZHRoID8gJChzZWxmKS53aWR0aCgpICA6IHNldHRpbmdzLndpZHRoOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3MuaGVpZ2h0ICE9ICdub25lJykgewogICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5oZWlnaHQgPSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzLmF1dG9oZWlnaHQgPyAkKHNlbGYpLmhlaWdodCgpIDogc2V0dGluZ3MuaGVpZ2h0OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vJCh0aGlzKS5jc3MoJ3Zpc2liaWxpdHknLCAnJyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8qIHJlbW92ZSBwbGFjZWhvbGRlciB0ZXh0LCByZXBsYWNlIGlzIGhlcmUgYmVjYXVzZSBvZiBJRSAqLwogICAgICAgICAgICAgICAgaWYgKCQodGhpcykuaHRtbCgpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvKDt8IikvZywgJycpID09IAogICAgICAgICAgICAgICAgICAgIHNldHRpbmdzLnBsYWNlaG9sZGVyLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvKDt8IikvZywgJycpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuaHRtbCgnJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzZWxmLmVkaXRpbmcgICAgPSB0cnVlOwogICAgICAgICAgICAgICAgc2VsZi5yZXZlcnQgICAgID0gJChzZWxmKS5odG1sKCk7CiAgICAgICAgICAgICAgICAkKHNlbGYpLmh0bWwoJycpOwoKICAgICAgICAgICAgICAgIC8qIGNyZWF0ZSB0aGUgZm9ybSBvYmplY3QgKi8KICAgICAgICAgICAgICAgIHZhciBmb3JtID0gJCgnPGZvcm0gLz4nKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLyogYXBwbHkgY3NzIG9yIHN0eWxlIG9yIGJvdGggKi8KICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5jc3NjbGFzcykgewogICAgICAgICAgICAgICAgICAgIGlmICgnaW5oZXJpdCcgPT0gc2V0dGluZ3MuY3NzY2xhc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5hdHRyKCdjbGFzcycsICQoc2VsZikuYXR0cignY2xhc3MnKSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5hdHRyKCdjbGFzcycsIHNldHRpbmdzLmNzc2NsYXNzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLnN0eWxlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCdpbmhlcml0JyA9PSBzZXR0aW5ncy5zdHlsZSkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmF0dHIoJ3N0eWxlJywgJChzZWxmKS5hdHRyKCdzdHlsZScpKTsKICAgICAgICAgICAgICAgICAgICAgICAgLyogSUUgbmVlZHMgdGhlIHNlY29uZCBsaW5lIG9yIGRpc3BsYXkgd29udCBiZSBpbmhlcml0ZWQgKi8KICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5jc3MoJ2Rpc3BsYXknLCAkKHNlbGYpLmNzcygnZGlzcGxheScpKTsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5hdHRyKCdzdHlsZScsIHNldHRpbmdzLnN0eWxlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLyogYWRkIG1haW4gaW5wdXQgZWxlbWVudCB0byBmb3JtIGFuZCBzdG9yZSBpdCBpbiBpbnB1dCAqLwogICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gZWxlbWVudC5hcHBseShmb3JtLCBbc2V0dGluZ3MsIHNlbGZdKTsKCiAgICAgICAgICAgICAgICAvKiBzZXQgaW5wdXQgY29udGVudCB2aWEgUE9TVCwgR0VULCBnaXZlbiBkYXRhIG9yIGV4aXN0aW5nIHZhbHVlICovCiAgICAgICAgICAgICAgICB2YXIgaW5wdXRfY29udGVudDsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmxvYWR1cmwpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudC5hcHBseShmb3JtLCBbc2V0dGluZ3MubG9hZHRleHQsIHNldHRpbmdzLCBzZWxmXSk7CiAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTsKCiAgICAgICAgICAgICAgICAgICAgdmFyIGxvYWRkYXRhID0ge307CiAgICAgICAgICAgICAgICAgICAgbG9hZGRhdGFbc2V0dGluZ3MuaWRdID0gc2VsZi5pZDsKICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKHNldHRpbmdzLmxvYWRkYXRhKSkgewogICAgICAgICAgICAgICAgICAgICAgICAkLmV4dGVuZChsb2FkZGF0YSwgc2V0dGluZ3MubG9hZGRhdGEuYXBwbHkoc2VsZiwgW3NlbGYucmV2ZXJ0LCBzZXR0aW5nc10pKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkLmV4dGVuZChsb2FkZGF0YSwgc2V0dGluZ3MubG9hZGRhdGEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgIHR5cGUgOiBzZXR0aW5ncy5sb2FkdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICB1cmwgIDogc2V0dGluZ3MubG9hZHVybCwKICAgICAgICAgICAgICAgICAgICAgICBkYXRhIDogbG9hZGRhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgYXN5bmMgOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0X2NvbnRlbnQgPSByZXN1bHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNldHRpbmdzLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dF9jb250ZW50ID0gc2V0dGluZ3MuZGF0YTsKICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKHNldHRpbmdzLmRhdGEpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0X2NvbnRlbnQgPSBzZXR0aW5ncy5kYXRhLmFwcGx5KHNlbGYsIFtzZWxmLnJldmVydCwgc2V0dGluZ3NdKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlucHV0X2NvbnRlbnQgPSBzZWxmLnJldmVydDsgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb250ZW50LmFwcGx5KGZvcm0sIFtpbnB1dF9jb250ZW50LCBzZXR0aW5ncywgc2VsZl0pOwoKICAgICAgICAgICAgICAgIGlucHV0LmF0dHIoJ25hbWUnLCBzZXR0aW5ncy5uYW1lKTsKICAgICAgICAKICAgICAgICAgICAgICAgIC8qIGFkZCBidXR0b25zIHRvIHRoZSBmb3JtICovCiAgICAgICAgICAgICAgICBidXR0b25zLmFwcGx5KGZvcm0sIFtzZXR0aW5ncywgc2VsZl0pOwogICAgICAgICAKICAgICAgICAgICAgICAgIC8qIGFkZCBjcmVhdGVkIGZvcm0gdG8gc2VsZiAqLwogICAgICAgICAgICAgICAgJChzZWxmKS5hcHBlbmQoZm9ybSk7CiAgICAgICAgIAogICAgICAgICAgICAgICAgLyogYXR0YWNoIDNyZCBwYXJ0eSBwbHVnaW4gaWYgcmVxdWVzdGVkICovCiAgICAgICAgICAgICAgICBwbHVnaW4uYXBwbHkoZm9ybSwgW3NldHRpbmdzLCBzZWxmXSk7CgogICAgICAgICAgICAgICAgLyogZm9jdXMgdG8gZmlyc3QgdmlzaWJsZSBmb3JtIGVsZW1lbnQgKi8KICAgICAgICAgICAgICAgICQoJzppbnB1dDp2aXNpYmxlOmVuYWJsZWQ6Zmlyc3QnLCBmb3JtKS5mb2N1cygpOwoKICAgICAgICAgICAgICAgIC8qIGhpZ2hsaWdodCBpbnB1dCBjb250ZW50cyB3aGVuIHJlcXVlc3RlZCAqLwogICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLnNlbGVjdCkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LnNlbGVjdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICAgICAgLyogZGlzY2FyZCBjaGFuZ2VzIGlmIHByZXNzaW5nIGVzYyAqLwogICAgICAgICAgICAgICAgaW5wdXQua2V5ZG93bihmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAyNykgewogICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vc2VsZi5yZXNldCgpOwogICAgICAgICAgICAgICAgICAgICAgICByZXNldC5hcHBseShmb3JtLCBbc2V0dGluZ3MsIHNlbGZdKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAvKiBkaXNjYXJkLCBzdWJtaXQgb3Igbm90aGluZyB3aXRoIGNoYW5nZXMgd2hlbiBjbGlja2luZyBvdXRzaWRlICovCiAgICAgICAgICAgICAgICAvKiBkbyBub3RoaW5nIGlzIHVzYWJsZSB3aGVuIG5hdmlnYXRpbmcgd2l0aCB0YWIgKi8KICAgICAgICAgICAgICAgIHZhciB0OwogICAgICAgICAgICAgICAgaWYgKCdjYW5jZWwnID09IHNldHRpbmdzLm9uYmx1cikgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmJsdXIoZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgICAgICAvKiBwcmV2ZW50IGNhbmNlbGluZyBpZiBzdWJtaXQgd2FzIGNsaWNrZWQgKi8KICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNldC5hcHBseShmb3JtLCBbc2V0dGluZ3MsIHNlbGZdKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoJ3N1Ym1pdCcgPT0gc2V0dGluZ3Mub25ibHVyKSB7CiAgICAgICAgICAgICAgICAgICAgaW5wdXQuYmx1cihmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHByZXZlbnQgZG91YmxlIHN1Ym1pdCBpZiBzdWJtaXQgd2FzIGNsaWNrZWQgKi8KICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnN1Ym1pdCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDApOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICgkLmlzRnVuY3Rpb24oc2V0dGluZ3Mub25ibHVyKSkgewogICAgICAgICAgICAgICAgICAgIGlucHV0LmJsdXIoZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5vbmJsdXIuYXBwbHkoc2VsZiwgW2lucHV0LnZhbCgpLCBzZXR0aW5nc10pOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpbnB1dC5ibHVyKGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICAgIC8qIFRPRE86IG1heWJlIHNvbWV0aGluZyBoZXJlICovCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZm9ybS5zdWJtaXQoZnVuY3Rpb24oZSkgewoKICAgICAgICAgICAgICAgICAgICBpZiAodCkgeyAKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHQpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLyogZG8gbm8gc3VibWl0ICovCiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLyogY2FsbCBiZWZvcmUgc3VibWl0IGhvb2suICovCiAgICAgICAgICAgICAgICAgICAgLyogaWYgaXQgcmV0dXJucyBmYWxzZSBhYm9ydCBzdWJtaXR0aW5nICovICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoZmFsc2UgIT09IG9uc3VibWl0LmFwcGx5KGZvcm0sIFtzZXR0aW5ncywgc2VsZl0pKSB7IAogICAgICAgICAgICAgICAgICAgICAgICAvKiBjdXN0b20gaW5wdXRzIGNhbGwgYmVmb3JlIHN1Ym1pdCBob29rLiAqLwogICAgICAgICAgICAgICAgICAgICAgICAvKiBpZiBpdCByZXR1cm5zIGZhbHNlIGFib3J0IHN1Ym1pdHRpbmcgKi8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZhbHNlICE9PSBzdWJtaXQuYXBwbHkoZm9ybSwgW3NldHRpbmdzLCBzZWxmXSkpIHsgCgogICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGNoZWNrIGlmIGdpdmVuIHRhcmdldCBpcyBmdW5jdGlvbiAqLwogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkLmlzRnVuY3Rpb24oc2V0dGluZ3MudGFyZ2V0KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gc2V0dGluZ3MudGFyZ2V0LmFwcGx5KHNlbGYsIFtpbnB1dC52YWwoKSwgc2V0dGluZ3NdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChzZWxmKS5odG1sKHN0cik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZWRpdGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseShzZWxmLCBbc2VsZi5pbm5lckhUTUwsIHNldHRpbmdzXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIFRPRE86IHRoaXMgaXMgbm90IGRyeSAqLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISQudHJpbSgkKHNlbGYpLmh0bWwoKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoc2VsZikuaHRtbChzZXR0aW5ncy5wbGFjZWhvbGRlcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBhZGQgZWRpdGVkIGNvbnRlbnQgYW5kIGlkIG9mIGVkaXRlZCBlbGVtZW50IHRvIFBPU1QgKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Ym1pdGRhdGEgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VibWl0ZGF0YVtzZXR0aW5ncy5uYW1lXSA9IGlucHV0LnZhbCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRkYXRhW3NldHRpbmdzLmlkXSA9IHNlbGYuaWQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGFkZCBleHRyYSBkYXRhIHRvIGJlIFBPU1Q6ZWQgKi8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNGdW5jdGlvbihzZXR0aW5ncy5zdWJtaXRkYXRhKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5leHRlbmQoc3VibWl0ZGF0YSwgc2V0dGluZ3Muc3VibWl0ZGF0YS5hcHBseShzZWxmLCBbc2VsZi5yZXZlcnQsIHNldHRpbmdzXSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5leHRlbmQoc3VibWl0ZGF0YSwgc2V0dGluZ3Muc3VibWl0ZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIHF1aWNrIGFuZCBkaXJ0eSBQVVQgc3VwcG9ydCAqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ1BVVCcgPT0gc2V0dGluZ3MubWV0aG9kKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXRkYXRhWydfbWV0aG9kJ10gPSAncHV0JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogc2hvdyB0aGUgc2F2aW5nIGluZGljYXRvciAqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHNlbGYpLmh0bWwoc2V0dGluZ3MuaW5kaWNhdG9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGRlZmF1bHRzIGZvciBhamF4b3B0aW9ucyAqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWpheG9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlICAgIDogJ1BPU1QnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSAgICA6IHN1Ym1pdGRhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2h0bWwnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsICAgICA6IHNldHRpbmdzLnRhcmdldCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgOiBmdW5jdGlvbihyZXN1bHQsIHN0YXR1cykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhamF4b3B0aW9ucy5kYXRhVHlwZSA9PSAnaHRtbCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoc2VsZikuaHRtbChyZXN1bHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmVkaXRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseShzZWxmLCBbcmVzdWx0LCBzZXR0aW5nc10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJC50cmltKCQoc2VsZikuaHRtbCgpKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHNlbGYpLmh0bWwoc2V0dGluZ3MucGxhY2Vob2xkZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciAgIDogZnVuY3Rpb24oeGhyLCBzdGF0dXMsIGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25lcnJvci5hcHBseShmb3JtLCBbc2V0dGluZ3MsIHNlbGYsIHhocl0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogb3ZlcnJpZGUgd2l0aCB3aGF0IGlzIGdpdmVuIGluIHNldHRpbmdzLmFqYXhvcHRpb25zICovCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZXh0ZW5kKGFqYXhvcHRpb25zLCBzZXR0aW5ncy5hamF4b3B0aW9ucyk7ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuYWpheChhamF4b3B0aW9ucyk7ICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvKiBzaG93IHRvb2x0aXAgYWdhaW4gKi8KICAgICAgICAgICAgICAgICAgICAkKHNlbGYpLmF0dHIoJ3RpdGxlJywgc2V0dGluZ3MudG9vbHRpcCk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgLyogcHJpdmlsZWdlZCBtZXRob2RzICovCiAgICAgICAgICAgIHRoaXMucmVzZXQgPSBmdW5jdGlvbihmb3JtKSB7CiAgICAgICAgICAgICAgICAvKiBwcmV2ZW50IGNhbGxpbmcgcmVzZXQgdHdpY2Ugd2hlbiBibHVycmluZyAqLwogICAgICAgICAgICAgICAgaWYgKHRoaXMuZWRpdGluZykgewogICAgICAgICAgICAgICAgICAgIC8qIGJlZm9yZSByZXNldCBob29rLCBpZiBpdCByZXR1cm5zIGZhbHNlIGFib3J0IHJlc2V0aW5nICovCiAgICAgICAgICAgICAgICAgICAgaWYgKGZhbHNlICE9PSBvbnJlc2V0LmFwcGx5KGZvcm0sIFtzZXR0aW5ncywgc2VsZl0pKSB7IAogICAgICAgICAgICAgICAgICAgICAgICAkKHNlbGYpLmh0bWwoc2VsZi5yZXZlcnQpOwogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmVkaXRpbmcgICA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoISQudHJpbSgkKHNlbGYpLmh0bWwoKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoc2VsZikuaHRtbChzZXR0aW5ncy5wbGFjZWhvbGRlcik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLyogc2hvdyB0b29sdGlwIGFnYWluICovCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy50b29sdGlwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHNlbGYpLmF0dHIoJ3RpdGxlJywgc2V0dGluZ3MudG9vbHRpcCk7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07ICAgICAgICAgICAgCiAgICAgICAgfSk7CgogICAgfTsKCgogICAgJC5lZGl0YWJsZSA9IHsKICAgICAgICB0eXBlczogewogICAgICAgICAgICBkZWZhdWx0czogewogICAgICAgICAgICAgICAgZWxlbWVudCA6IGZ1bmN0aW9uKHNldHRpbmdzLCBvcmlnaW5hbCkgewogICAgICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9ICQoJzxpbnB1dCB0eXBlPSJoaWRkZW4iPjwvaW5wdXQ+Jyk7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICQodGhpcykuYXBwZW5kKGlucHV0KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4oaW5wdXQpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNvbnRlbnQgOiBmdW5jdGlvbihzdHJpbmcsIHNldHRpbmdzLCBvcmlnaW5hbCkgewogICAgICAgICAgICAgICAgICAgICQoJzppbnB1dDpmaXJzdCcsIHRoaXMpLnZhbChzdHJpbmcpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHJlc2V0IDogZnVuY3Rpb24oc2V0dGluZ3MsIG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgICAgIG9yaWdpbmFsLnJlc2V0KHRoaXMpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGJ1dHRvbnMgOiBmdW5jdGlvbihzZXR0aW5ncywgb3JpZ2luYWwpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IHRoaXM7CiAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLnN1Ym1pdCkgewogICAgICAgICAgICAgICAgICAgICAgICAvKiBpZiBnaXZlbiBodG1sIHN0cmluZyB1c2UgdGhhdCAqLwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3Muc3VibWl0Lm1hdGNoKC8+JC8pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VibWl0ID0gJChzZXR0aW5ncy5zdWJtaXQpLmNsaWNrKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJtaXQuYXR0cigidHlwZSIpICE9ICJzdWJtaXQiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uc3VibWl0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8qIG90aGVyd2lzZSB1c2UgYnV0dG9uIHdpdGggZ2l2ZW4gc3RyaW5nIGFzIHRleHQgKi8KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJtaXQgPSAkKCc8YnV0dG9uIHR5cGU9InN1Ym1pdCIgLz4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdC5odG1sKHNldHRpbmdzLnN1Ym1pdCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuYXBwZW5kKHN1Ym1pdCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5jYW5jZWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLyogaWYgZ2l2ZW4gaHRtbCBzdHJpbmcgdXNlIHRoYXQgKi8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLmNhbmNlbC5tYXRjaCgvPiQvKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbmNlbCA9ICQoc2V0dGluZ3MuY2FuY2VsKTsKICAgICAgICAgICAgICAgICAgICAgICAgLyogb3RoZXJ3aXNlIHVzZSBidXR0b24gd2l0aCBnaXZlbiBzdHJpbmcgYXMgdGV4dCAqLwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbmNlbCA9ICQoJzxidXR0b24gdHlwZT0iY2FuY2VsIiAvPicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsLmh0bWwoc2V0dGluZ3MuY2FuY2VsKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFwcGVuZChjYW5jZWwpOwoKICAgICAgICAgICAgICAgICAgICAgICAgJChjYW5jZWwpLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL29yaWdpbmFsLnJlc2V0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKCQuZWRpdGFibGUudHlwZXNbc2V0dGluZ3MudHlwZV0ucmVzZXQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc2V0ID0gJC5lZGl0YWJsZS50eXBlc1tzZXR0aW5ncy50eXBlXS5yZXNldDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNldCA9ICQuZWRpdGFibGUudHlwZXNbJ2RlZmF1bHRzJ10ucmVzZXQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2V0LmFwcGx5KGZvcm0sIFtzZXR0aW5ncywgb3JpZ2luYWxdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB0ZXh0OiB7CiAgICAgICAgICAgICAgICBlbGVtZW50IDogZnVuY3Rpb24oc2V0dGluZ3MsIG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlucHV0ID0gJCgnPGlucHV0IC8+Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzLndpZHRoICAhPSAnbm9uZScpIHsgaW5wdXQud2lkdGgoc2V0dGluZ3Mud2lkdGgpOyAgfQogICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5oZWlnaHQgIT0gJ25vbmUnKSB7IGlucHV0LmhlaWdodChzZXR0aW5ncy5oZWlnaHQpOyB9CiAgICAgICAgICAgICAgICAgICAgLyogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjM2NzkxICovCiAgICAgICAgICAgICAgICAgICAgLy9pbnB1dFswXS5zZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScsJ29mZicpOwogICAgICAgICAgICAgICAgICAgIGlucHV0LmF0dHIoJ2F1dG9jb21wbGV0ZScsJ29mZicpOwogICAgICAgICAgICAgICAgICAgICQodGhpcykuYXBwZW5kKGlucHV0KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4oaW5wdXQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB0ZXh0YXJlYTogewogICAgICAgICAgICAgICAgZWxlbWVudCA6IGZ1bmN0aW9uKHNldHRpbmdzLCBvcmlnaW5hbCkgewogICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0YXJlYSA9ICQoJzx0ZXh0YXJlYSAvPicpOwogICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5yb3dzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRhcmVhLmF0dHIoJ3Jvd3MnLCBzZXR0aW5ncy5yb3dzKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNldHRpbmdzLmhlaWdodCAhPSAibm9uZSIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dGFyZWEuaGVpZ2h0KHNldHRpbmdzLmhlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5jb2xzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRhcmVhLmF0dHIoJ2NvbHMnLCBzZXR0aW5ncy5jb2xzKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNldHRpbmdzLndpZHRoICE9ICJub25lIikgewogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0YXJlYS53aWR0aChzZXR0aW5ncy53aWR0aCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICQodGhpcykuYXBwZW5kKHRleHRhcmVhKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4odGV4dGFyZWEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBzZWxlY3Q6IHsKICAgICAgICAgICAgICAgZWxlbWVudCA6IGZ1bmN0aW9uKHNldHRpbmdzLCBvcmlnaW5hbCkgewogICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3QgPSAkKCc8c2VsZWN0IC8+Jyk7CiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hcHBlbmQoc2VsZWN0KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4oc2VsZWN0KTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjb250ZW50IDogZnVuY3Rpb24oZGF0YSwgc2V0dGluZ3MsIG9yaWdpbmFsKSB7CiAgICAgICAgICAgICAgICAgICAgLyogSWYgaXQgaXMgc3RyaW5nIGFzc3VtZSBpdCBpcyBqc29uLiAqLwogICAgICAgICAgICAgICAgICAgIGlmIChTdHJpbmcgPT0gZGF0YS5jb25zdHJ1Y3RvcikgeyAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBldmFsICgndmFyIGpzb24gPSAnICsgZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvKiBPdGhlcndpc2UgYXNzdW1lIGl0IGlzIGEgaGFzaCBhbHJlYWR5LiAqLwogICAgICAgICAgICAgICAgICAgICAgICB2YXIganNvbiA9IGRhdGE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBqc29uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghanNvbi5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ3NlbGVjdGVkJyA9PSBrZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gJCgnPG9wdGlvbiAvPicpLnZhbChrZXkpLmFwcGVuZChqc29uW2tleV0pOwogICAgICAgICAgICAgICAgICAgICAgICAkKCdzZWxlY3QnLCB0aGlzKS5hcHBlbmQob3B0aW9uKTsgICAgCiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLyogTG9vcCBvcHRpb24gYWdhaW4gdG8gc2V0IHNlbGVjdGVkLiBJRSBuZWVkZWQgdGhpcy4uLiAqLyAKICAgICAgICAgICAgICAgICAgICAkKCdzZWxlY3QnLCB0aGlzKS5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLnZhbCgpID09IGpzb25bJ3NlbGVjdGVkJ10gfHwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnRleHQoKSA9PSAkLnRyaW0ob3JpZ2luYWwucmV2ZXJ0KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuYXR0cignc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgLyogQWRkIG5ldyBpbnB1dCB0eXBlICovCiAgICAgICAgYWRkSW5wdXRUeXBlOiBmdW5jdGlvbihuYW1lLCBpbnB1dCkgewogICAgICAgICAgICAkLmVkaXRhYmxlLnR5cGVzW25hbWVdID0gaW5wdXQ7CiAgICAgICAgfQogICAgfTsKCiAgICAvLyBwdWJsaWNseSBhY2Nlc3NpYmxlIGRlZmF1bHRzCiAgICAkLmZuLmVkaXRhYmxlLmRlZmF1bHRzID0gewogICAgICAgIG5hbWUgICAgICAgOiAndmFsdWUnLAogICAgICAgIGlkICAgICAgICAgOiAnaWQnLAogICAgICAgIHR5cGUgICAgICAgOiAndGV4dCcsCiAgICAgICAgd2lkdGggICAgICA6ICdhdXRvJywKICAgICAgICBoZWlnaHQgICAgIDogJ2F1dG8nLAogICAgICAgIGV2ZW50ICAgICAgOiAnY2xpY2suZWRpdGFibGUnLAogICAgICAgIG9uYmx1ciAgICAgOiAnY2FuY2VsJywKICAgICAgICBsb2FkdHlwZSAgIDogJ0dFVCcsCiAgICAgICAgbG9hZHRleHQgICA6ICdMb2FkaW5nLi4uJywKICAgICAgICBwbGFjZWhvbGRlcjogJ0NsaWNrIHRvIGVkaXQnLAogICAgICAgIGxvYWRkYXRhICAgOiB7fSwKICAgICAgICBzdWJtaXRkYXRhIDoge30sCiAgICAgICAgYWpheG9wdGlvbnM6IHt9CiAgICB9OwoKfSkoalF1ZXJ5KTs="

#endif
